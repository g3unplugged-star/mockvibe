<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results - MockVibe</title>
    <style>
        :root {
            --primary: #8E2DE2;
            --secondary: #4A00E0;
            --accent: #00DBDE;
            --pink: #FC00FF;
            --gradient: linear-gradient(45deg, #00DBDE, #FC00FF);
            --bg-gradient: linear-gradient(135deg, #8E2DE2 0%, #4A00E0 100%);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: white;
            padding: 20px;
        }
        
        .results-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        /* Header */
        .results-header {
            text-align: center;
            padding: 30px 20px;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        .results-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* Score Circle */
        .score-circle-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }
        
        .score-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            position: relative;
            border: 10px solid;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .score-main {
            font-size: 3.5rem;
            font-weight: bold;
            line-height: 1;
        }
        
        .score-percentage {
            font-size: 1.5rem;
            margin-top: 5px;
            opacity: 0.9;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.15);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.12);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        /* Details */
        .details-section {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin: 40px 0;
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .detail-item {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        /* Actions */
        .actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 15px 35px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 180px;
        }
        
        .primary-btn {
            background: var(--gradient);
            color: white;
        }
        
        .secondary-btn {
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }
        
        .action-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }
        
        /* Performance */
        .performance {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }
        
        .performance-bar {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .performance-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 1s ease;
        }
        
        /* Footer */
        .results-footer {
            text-align: center;
            padding: 40px 20px;
            margin-top: 50px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        @media (max-width: 768px) {
            .actions { flex-direction: column; }
            .action-btn { width: 100%; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .score-circle { width: 150px; height: 150px; }
            .score-main { font-size: 2.5rem; }
        }
        
        @media (max-width: 480px) {
            .stats-grid { grid-template-columns: 1fr; }
            .details-grid { grid-template-columns: 1fr; }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="results-container">
        <!-- Header -->
        <div class="results-header">
            <h1><i class="fas fa-trophy"></i> Test Results</h1>
            <p id="testName">Mock Test</p>
            <p id="testDate">Date: Loading...</p>
        </div>
        
        <!-- Score Circle -->
        <div class="score-circle-container">
            <div class="score-circle" id="scoreCircle">
                <div class="score-main" id="scoreDisplay">0/0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
            </div>
        </div>
        
        <!-- Message -->
        <div class="details-section" style="text-align: center;">
            <h2 id="resultMessage">Calculating your result...</h2>
            <p id="resultSubMessage" style="opacity: 0.8; margin-top: 10px;"></p>
        </div>
        
        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="correctCount">0</div>
                <div>Correct Answers</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="incorrectCount">0</div>
                <div>Incorrect Answers</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="unansweredCount">0</div>
                <div>Unanswered</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="timeTaken">0:00</div>
                <div>Time Taken</div>
            </div>
        </div>
        
        <!-- Performance -->
        <div class="details-section">
            <h2><i class="fas fa-chart-line"></i> Performance Analysis</h2>
            
            <div class="performance">
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <span>Accuracy</span>
                    <span id="accuracyText">0%</span>
                </div>
                <div class="performance-bar">
                    <div class="performance-fill" id="accuracyBar" 
                         style="background: var(--gradient); width: 0%;"></div>
                </div>
            </div>
            
            <div class="details-grid">
                <div class="detail-item">
                    <h3><i class="fas fa-check-circle"></i> Correct Questions</h3>
                    <p id="correctList" style="margin-top: 10px;">None</p>
                </div>
                <div class="detail-item">
                    <h3><i class="fas fa-times-circle"></i> Incorrect Questions</h3>
                    <p id="incorrectList" style="margin-top: 10px;">None</p>
                </div>
            </div>
        </div>
        
        <!-- Actions -->
        <div class="actions">
            <a href="index.html" class="action-btn primary-btn">
                <i class="fas fa-home"></i> Back to Home
            </a>
            <a href="test.html" class="action-btn secondary-btn" onclick="retakeTest()">
                <i class="fas fa-redo"></i> Retake Test
            </a>
            <button class="action-btn secondary-btn" onclick="shareResult()">
                <i class="fas fa-share-alt"></i> Share Result
            </button>
            <button class="action-btn secondary-btn" onclick="viewDetails()">
                <i class="fas fa-info-circle"></i> View Details
            </button>
        </div>
        
        <!-- Test History -->
        <div class="details-section" id="historySection" style="display: none;">
            <h2><i class="fas fa-history"></i> Recent Tests</h2>
            <div id="testHistory">
                <!-- History will be loaded here -->
            </div>
        </div>
        
        <!-- Footer -->
        <div class="results-footer">
            <p>MockVibe - Feel the Vibe, Ace the Test! üöÄ</p>
            <p style="margin-top: 15px; opacity: 0.8;">
                <i class="fas fa-lightbulb"></i> Tip: Practice daily to improve your score!
            </p>
            <div style="margin-top: 30px;">
                <a href="#" onclick="toggleHistory()" style="color: var(--accent); text-decoration: none;">
                    <i class="fas fa-history"></i> View Test History
                </a>
            </div>
        </div>
    </div>

    <script>
        // MockVibe Results Engine
        class MockVibeResults {
            constructor() {
                this.result = null;
                this.history = [];
            }
            
            init() {
                this.loadResult();
                this.loadHistory();
                this.displayResult();
            }
            
            loadResult() {
                const resultStr = localStorage.getItem('mockvibe_last_result');
                if (resultStr) {
                    this.result = JSON.parse(resultStr);
                } else {
                    // Demo result for testing
                    this.result = {
                        score: 3,
                        total: 5,
                        percentage: "60.0",
                        correct: [1, 2, 5],
                        incorrect: [4],
                        unanswered: 1,
                        timeTaken: "5:30",
                        testName: "Quantitative Aptitude",
                        timestamp: new Date().toISOString()
                    };
                }
            }
            
            loadHistory() {
                const historyStr = localStorage.getItem('mockvibe_history');
                this.history = historyStr ? JSON.parse(historyStr) : [];
                this.history.reverse(); // Show latest first
            }
            
            displayResult() {
                if (!this.result) return;
                
                // Basic info
                document.getElementById('testName').textContent = this.result.testName;
                document.getElementById('testDate').textContent = 
                    `Date: ${new Date(this.result.timestamp).toLocaleDateString('en-IN')}`;
                
                // Score display
                document.getElementById('scoreDisplay').textContent = 
                    `${this.result.score}/${this.result.total}`;
                document.getElementById('scorePercentage').textContent = 
                    `${this.result.percentage}%`;
                
                // Stats
                document.getElementById('correctCount').textContent = this.result.score;
                document.getElementById('incorrectCount').textContent = this.result.incorrect.length;
                document.getElementById('unansweredCount').textContent = this.result.unanswered;
                document.getElementById('timeTaken').textContent = this.result.timeTaken;
                
                // Correct/Incorrect lists
                document.getElementById('correctList').textContent = 
                    this.result.correct.length > 0 ? this.result.correct.join(', ') : 'None';
                document.getElementById('incorrectList').textContent = 
                    this.result.incorrect.length > 0 ? this.result.incorrect.join(', ') : 'None';
                
                // Accuracy
                const accuracy = parseFloat(this.result.percentage);
                document.getElementById('accuracyText').textContent = `${accuracy}%`;
                
                // Animate accuracy bar
                setTimeout(() => {
                    document.getElementById('accuracyBar').style.width = `${accuracy}%`;
                }, 500);
                
                // Set score circle color
                this.setScoreColor(accuracy);
                
                // Set message
                this.setResultMessage(accuracy);
                
                // Display history
                this.displayHistory();
            }
            
            setScoreColor(accuracy) {
                const circle = document.getElementById('scoreCircle');
                if (accuracy >= 80) {
                    circle.style.borderColor = '#4CAF50';
                    circle.style.background = 'rgba(76, 175, 80, 0.1)';
                } else if (accuracy >= 60) {
                    circle.style.borderColor = '#2196F3';
                    circle.style.background = 'rgba(33, 150, 243, 0.1)';
                } else if (accuracy >= 40) {
                    circle.style.borderColor = '#FF9800';
                    circle.style.background = 'rgba(255, 152, 0, 0.1)';
                } else {
                    circle.style.borderColor = '#f44336';
                    circle.style.background = 'rgba(244, 67, 54, 0.1)';
                }
            }
            
            setResultMessage(accuracy) {
                const messageEl = document.getElementById('resultMessage');
                const subMessageEl = document.getElementById('resultSubMessage');
                
                let message = '';
                let subMessage = '';
                let emoji = '';
                
                if (accuracy >= 90) {
                    message = 'Outstanding! üéâ';
                    subMessage = 'You are among the top performers!';
                    emoji = 'üèÜ';
                } else if (accuracy >= 75) {
                    message = 'Excellent Work! üëç';
                    subMessage = 'Keep up the great performance!';
                    emoji = '‚≠ê';
                } else if (accuracy >= 60) {
                    message = 'Good Job! üí™';
                    subMessage = 'You are on the right track!';
                    emoji = '‚ú®';
                } else if (accuracy >= 40) {
                    message = 'Keep Practicing! üìö';
                    subMessage = 'Focus on weak areas to improve.';
                    emoji = 'üîç';
                } else {
                    message = 'Never Give Up! üå±';
                    subMessage = 'Every practice session makes you better.';
                    emoji = 'üöÄ';
                }
                
                messageEl.innerHTML = `${emoji} ${message}`;
                subMessageEl.textContent = subMessage;
            }
            
            displayHistory() {
                const historyContainer = document.getElementById('testHistory');
                if (this.history.length === 0) {
                    historyContainer.innerHTML = '<p style="text-align: center; opacity: 0.7;">No test history yet.</p>';
                    return;
                }
                
                let html = '<div style="display: grid; gap: 10px;">';
                this.history.slice(0, 5).forEach((test, index) => {
                    const accuracy = parseFloat(test.percentage);
                    let color = '#f44336';
                    if (accuracy >= 60) color = '#FF9800';
                    if (accuracy >= 75) color = '#4CAF50';
                    
                    html += `
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong>${test.testName}</strong>
                                    <div style="font-size: 0.9rem; opacity: 0.8;">
                                        ${test.date} ‚Ä¢ ${test.time}
                                    </div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 1.2rem; font-weight: bold; color: ${color};">
                                        ${test.percentage}%
                                    </div>
                                    <div style="font-size: 0.9rem;">
                                        ${test.score}/${test.total}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                
                historyContainer.innerHTML = html;
            }
            
            // Additional functions
            shareResult() {
                if (!this.result) return;
                
                const text = `I scored ${this.result.score}/${this.result.total} (${this.result.percentage}%) on MockVibe! 
Try it at: ${window.location.origin}`;
                
                if (navigator.share) {
                    navigator.share({
                        title: 'My MockVibe Test Result',
                        text: text,
                        url: window.location.href
                    });
                } else {
                    navigator.clipboard.writeText(text)
                        .then(() => alert('Result copied to clipboard! Share with your friends. üìã'))
                        .catch(() => alert('Please manually copy the result text.'));
                }
            }
            
            viewDetails() {
                if (!this.result || !this.result.questions) {
                    alert('Detailed analysis coming soon!');
                    return;
                }
                
                let details = 'Question-wise Analysis:\n\n';
                this.result.questions.forEach((q, i) => {
                    const status = q.isCorrect ? '‚úì Correct' : q.userAnswer === undefined ? '‚óã Unanswered' : '‚úó Incorrect';
                    details += `Q${i+1}: ${status}\n`;
                });
                
                alert(details);
            }
        }
        
        // Global functions
        function retakeTest() {
            if (confirm('Start a new test?')) {
                window.location.href = 'test.html';
            }
        }
        
        function toggleHistory() {
            const section = document.getElementById('historySection');
            section.style.display = section.style.display === 'none' ? 'block' : 'none';
        }
        
        function viewDetails() {
            if (window.resultsEngine) {
                window.resultsEngine.viewDetails();
            }
        }
        
        function shareResult() {
            if (window.resultsEngine) {
                window.resultsEngine.shareResult();
            }
        }
        
        // Initialize
        window.onload = function() {
            window.resultsEngine = new MockVibeResults();
            window.resultsEngine.init();
            
            // Add confetti effect for good scores
            const result = JSON.parse(localStorage.getItem('mockvibe_last_result') || '{}');
            const percentage = parseFloat(result.percentage || 0);
            
            if (percentage >= 75) {
                setTimeout(() => {
                    console.log('üéâ Great score! Add confetti here later!');
                }, 1000);
            }
        };
    </script>
</body>
</html>
